{"https://moirai2.github.io/schema/daemon/input":"$bam","https://moirai2.github.io/schema/daemon/bash":["multimap=$tmpdir/multimap.fq.gz","filtered=$tmpdir/filtered.fq.gz","perl $tmpdir/filter.pl $bam $multimap $filtered"],"https://moirai2.github.io/schema/daemon/script":{"https://moirai2.github.io/schema/daemon/script/name":"$tmpdir/filter.pl","https://moirai2.github.io/schema/daemon/script/code":["my $input=$ARGV[0];","my $multimap=$ARGV[1];","my $filtered=$ARGV[2];","open(IN,\"samtools view $input |\");","open(MULTI,\"|gzip>$multimap\");","open(FILTERED,\"|gzip>$filtered\");","while(<IN>){","if(/^@/){next;}","chomp;s/\r//g;","my ($qname,$flag,$rname,$pos,$mapq,$cigar,$rnext,$pnexxt,$tlen,$seq,$qual,@others)=split(/\t/);","my $multi=0;","foreach my $other(@others){if($other=~/uT:A:3/){$multi=1;}}","if($multi){print MULTI \"\@$qname\n$seq\n+\n$qual\n\";}","else{print FILTERED \"\@$qname\n$seq\n+\n$qual\n\";}","}","close(IN);","close(MULTI);","close(FILTERED);"]},"https://moirai2.github.io/schema/daemon/output":["$filtered","$multimap"]}
