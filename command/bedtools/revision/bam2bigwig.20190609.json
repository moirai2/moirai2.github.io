{"https://moirai2.github.io/schema/daemon/input":"$bam","https://moirai2.github.io/schema/daemon/bash":["basename=`basename $bam .bam`","bed=\"$tmpdir/$basename.bed\"","bedGraph=\"$tmpdir/$basename.bedGraph\"","bigWig=\"$tmpdir/$basename.bw\"","genomefile=\"$tmpdir/genome.txt\";","samtools view -H $bam|perl $tmpdir/extract.pl > $genomefile","bamToBed -i $bam > $bed","bedtools genomecov -bg -i $bed -g $genomefile > $bedGraph ","bedGraphToBigWig $bedGraph $genomefile $bigWig","rm $bed $bedGraph $genomefile"],"https://moirai2.github.io/schema/daemon/script":{"https://moirai2.github.io/schema/daemon/script/name":"$tmpdir/extract.pl","https://moirai2.github.io/schema/daemon/script/code":["my @chromosomes={};","while(<STDIN>){","chomp;","if(/^\\\\@SQ\\\\t(.+)$/){","my $chromosome;","my $size;","foreach my $token(split(/\\\\t/,$1)){","my ($key,$val)=split(/\\\\:/,$token);","if($key eq \"SN\"){$chromosome=$val;}","if($key eq \"LN\"){$size=$val;}","}","$chromosomes->{$chromosome}=$size;","}","}","foreach my $chromosome(sort{$a cmp $b}keys(%{$chromosomes})){","my $size=$chromosomes->{$chromosome};","print \"$chromosome\\\\t$size\\\\n\";","}"]},"https://moirai2.github.io/schema/daemon/output":"$bigWig"}
